
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../hardware/">
      
      
        <link rel="next" href="../electrical/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Software Guide - EchoTherm Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#software-configuration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../.."> 
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://echomav.com" title="EchoTherm Documentation" class="md-header__button md-logo" aria-label="EchoTherm Documentation" data-md-component="logo">
      
  <img src="../assets/echomav-small-black-bg.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EchoTherm Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Software Guide
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/EchoMAV/echotherm_docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    echomav/echotherm_docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://echomav.com" title="EchoTherm Documentation" class="md-nav__button md-logo" aria-label="EchoTherm Documentation" data-md-component="logo">
      
  <img src="../assets/echomav-small-black-bg.png" alt="logo">

    </a>
    EchoTherm Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/EchoMAV/echotherm_docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    echomav/echotherm_docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Start
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../userguide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../hardware/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hardware Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Software Guide
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Software Guide
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#default-installed-jetson-software" class="md-nav__link">
    <span class="md-ellipsis">
      Default Installed Jetson Software
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#default-autopilot-software-and-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Default Autopilot Software and Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#telemetry-data-between-the-autopilot-and-the-jetson" class="md-nav__link">
    <span class="md-ellipsis">
      Telemetry data between the Autopilot and the Jetson
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Telemetry data between the Autopilot and the Jetson">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#access-the-telemetry-stream-with-your-own-application" class="md-nav__link">
    <span class="md-ellipsis">
      Access the telemetry stream with your own application
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aditional-information-related-to-septentrio-gnss" class="md-nav__link">
    <span class="md-ellipsis">
      Aditional information related to Septentrio GNSS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Aditional information related to Septentrio GNSS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-the-septentrio-h-for-both-gnss-position-and-heading" class="md-nav__link">
    <span class="md-ellipsis">
      Using the Septentrio H for both GNSS position and heading.
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unique-board-identifier" class="md-nav__link">
    <span class="md-ellipsis">
      Unique Board Identifier
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../electrical/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pinouts
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../mechanical/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mechanical
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/EchoMAV/echotherm_docs/edit/master/echotherm_docs/software.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/EchoMAV/echotherm_docs/raw/master/echotherm_docs/software.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="software-configuration">Software Configuration<a class="headerlink" href="#software-configuration" title="Permanent link">&para;</a></h1>
<h2 id="default-installed-jetson-software">Default Installed Jetson Software<a class="headerlink" href="#default-installed-jetson-software" title="Permanent link">&para;</a></h2>
<p>From the factory, the autopilot system of each EchoTherm system is provisioned with ArduRover(Boat) (latest stable release), and the Jetson is flashed with Jetson L4T 35.4.1 (or later). Minimal open-source <a href="https://github.com/EchoMAV/echopilot_deploy">software</a> is installed on the Jetson module as described below.</p>
<ul>
<li>
<p>Cockpit</p>
<p><a href="https://cockpit-project.org/">Cockpit</a> provides a web-based user interface which allows the user remote access into the system using any web browser. The access the system, from a host computer on the same network, browse to <code>https://IP_ADDRESS</code> where IP_ADDRESS is the IP Address of the EchoTherm system (see system label). Once logged into the web UI, there are many features including service monitoring, system settings and a web-based terminal.</p>
</li>
<li>
<p>Mavlink-router</p>
<p><a href="https://github.com/EchoMAV/mavlink-router">Mavlink-router</a> is an open source tool used to receive telemetry from the autopilot via a serial port and stream it to an IP endpoint (10.223.1.10:14550 over UDP by default). This software is open source and you are free to review the <a href="https://github.com/EchoMAV/echopilot_deploy">installation scripts</a> or reinstall/remove the software. </p>
<p>Default telemetry will stream to <code>10.223.1.10:14550</code> using UDP (client mode). This will allow automatic connection to common Ground Control Stations including QGroundControl and Mission Planner. For this to work, your host computer must be set to <code>10.223.1.10</code> and the EchoPilot AI must have a <a href="../userguide/#ip-configuration">network connection</a> between one of the Ethernet ports and the host computer. Once you get this basic telemetry set up working, then we suggest moving to your final desired telemetry configuration.</p>
<p>The Cockpit web application has been set up to allow basic configuration changes to Mavlink-router including connection mode, endpoint IP and Port and the input serial port connected to the autopilot system. While we believe this will be sufficient for the majority of applications, Mavlink-router can be configured with much more complicated scenarios, in which case we recommend NOT using the webUI and rather editing <code>etc\mavlink-router\main.conf</code> directly. </p>
</li>
</ul>
<h2 id="default-autopilot-software-and-configuration">Default Autopilot Software and Configuration<a class="headerlink" href="#default-autopilot-software-and-configuration" title="Permanent link">&para;</a></h2>
<p>By default, the EchoTherm system will come from the factory with <strong>ArduRover(Boat)</strong> installed and bench tested. The following important ArduPilot parameters are set to ensure connectivity to the Jetson and proper use of the Septentrio GNSS systems:</p>
<table>
<thead>
<tr>
<th>ArduPilot Parameter</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>SERIAL2_PROTOCOL</td>
<td>MAVLink2</td>
<td>The telemetry connection between the FMU and Jetson</td>
</tr>
<tr>
<td>SERIAL2_BAUD</td>
<td>500</td>
<td>500,000 bps baud rate</td>
</tr>
<tr>
<td>GPS_AUTO_CONFIG</td>
<td>0 (Disabled)</td>
<td>Disables GPS Auto Configuration</td>
</tr>
<tr>
<td>GPS_TYPE</td>
<td>10 (SBF)</td>
<td>Sets GPS 1 type to SBF</td>
</tr>
<tr>
<td>GPS_TYPE2</td>
<td>10 (SBF)</td>
<td>Sets GPS 2 type to SBF</td>
</tr>
<tr>
<td>SERIAL1_PROTOCOL</td>
<td>5 (GPS)</td>
<td>Sets serial port 1 to use as GPS</td>
</tr>
<tr>
<td>SERIAL1_BAUD</td>
<td>115 (115,200)</td>
<td>Sets serial port 1 baud rate to 115,200</td>
</tr>
<tr>
<td>SERIAL3_PROTOCOL</td>
<td>5 (GPS)</td>
<td>Sets serial port 3 to use as GPS</td>
</tr>
<tr>
<td>SERIAL3_BAUD</td>
<td>115 (115,200)</td>
<td>Sets serial port 3 baud rate to 115,200</td>
</tr>
</tbody>
</table>
<p>The hardware is compatible with other variants of ArduPilot (e.g. Plane, Sub, etc.) as well as the PX4 autopilot project. Instructions for how to flash other versions of firmware can be found at the links below:</p>
<ul>
<li><a href="https://echomav.github.io/docs/latest/build_ardupilot/">Flashing ArduPilot</a></li>
<li><a href="https://echomav.github.io/docs/latest/build_px4/">Flashing PX4</a></li>
</ul>
<p>If you flash PX4, the following parameters would need to be set to ensure connectivity to the Jetson:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>MAV_1_CONFIG 102: Telem 2  ## Reboot after this change to expose additional parameters
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>MAV_1_RATE: 0
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>MAV_1_MODE 2: Onboard
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>SER_TEL2_BAUD: 500000   ## Reboot after this change
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>## other parameters will be needed for proper GNSS configuration. Please contact EchoMAV if you plan to use the EchoTherm system with PX4 firmware.
</code></pre></div>
<h2 id="telemetry-data-between-the-autopilot-and-the-jetson">Telemetry data between the Autopilot and the Jetson<a class="headerlink" href="#telemetry-data-between-the-autopilot-and-the-jetson" title="Permanent link">&para;</a></h2>
<p>The autopilot has a high-speed serial interface between the FMU/STM32H7 and the Jetson SOM. The Jetson UART1 (pins 203, 205) is connected to the autopilot's USART3 (SERIAL2).</p>
<p>On the Jetson side, UART1 is typically enumerated as <code>/dev/ttyTHS0</code>, although it could vary with different Jetson modules including <code>/dev/ttyTHS1</code> and <code>/dev/ttyTHS2</code>.</p>
<p>For using the EchoPilot AI to route MAVLink data over a network, we pre-install and recommend <a href="https://github.com/mavlink-router/mavlink-router">MAVLink Router</a>. By default, mavlink-router is configured to push telemetry via UDP to <code>10.223.1.10:14550</code></p>
<p>Should you need or want to install this independently, EchoMAV has an open-source installer which makes it easy to install MAVLink Router and configure it as a service which starts at boot. Please refer to the our installer repo <a href="https://github.com/EchoMAV/mavlink-router">https://github.com/EchoMAV/mavlink-router</a> for instructions. </p>
<p>If you use the install repo above, please refer to the instructions there for configuration of the UART and destination IP address. Specifically edit <code>etc\mavlink-router\main.conf</code> with the appropriate settings.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you manually configure mavlink-router by modifying <code>etc\mavlink-router\main.conf</code>, the default web user interface may show incorrect data related to telemetry settings, or may overwrite your desired settings if saved from the web-UI. If you are working with this file, you may choose to edit the cockpit files which control telemetry settings to match your needs, or remove this feature from the web UI completely. Please see associated files <a href="https://github.com/EchoMAV/echopilot_deploy/tree/master/ui/general">https://github.com/EchoMAV/echopilot_deploy/tree/master/ui/general</a>.</p>
</div>
<p>If you have permission issues accessing <code>/dev/ttyTHSX</code> on the Jetson, please disable <code>nvgetty</code> and ensure you are a member of the <code>dialout</code> group as shown below.
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>sudo systemctl stop nvgetty
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>sudo systemctl disable nvgetty
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>sudo usermod -aG dialout $USER
</code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Reboot to apply changes.</p>
</div>
<h3 id="access-the-telemetry-stream-with-your-own-application">Access the telemetry stream with your own application<a class="headerlink" href="#access-the-telemetry-stream-with-your-own-application" title="Permanent link">&para;</a></h3>
<p>If you wish to develop your own application to parse the vehicle's telemetry, you can disable mavlink-router using:
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>sudo systemctl stop mavlink-router
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>sudo systemctl disable mavlink-router
</code></pre></div>
At this point, you can install your own application, which opens <code>/dev/ttyTHS0</code> (on most Jetson systems) at 500,000 kbps and uses a <a href="https://mavlink.io/en/getting_started/use_libraries.html">mavlink parser library</a> to parse the byte stream.</p>
<h2 id="aditional-information-related-to-septentrio-gnss">Aditional information related to Septentrio GNSS<a class="headerlink" href="#aditional-information-related-to-septentrio-gnss" title="Permanent link">&para;</a></h2>
<p>The Septentrio X5 and H units must be configured to output an SBF stream on COM1 before they will work with ArduPilot. The instructions to do so are below:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is recommended to apply the ArduPilot parameters <a href="#default-autopilot-software-and-configuration">defined above</a> BEFORE configuring the Septentrio GNSS systems.</p>
</div>
<p><a class="glightbox" href="../assets/inside_box.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Inside Box" src="../assets/inside_box.png" /></a></p>
<ol>
<li>Apply power to the EchoTherm system, open the lid, and connect to the USB configuration port for the GNSS port you wish to configure (either the X-5 or the H).</li>
<li>Many USB devices will enumerate, including one which should be a RNDIS network interface.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On Windows, you will need to install the driver before the RNDIS network device will function. The installer is located in the <code>driver</code> folder which will be available in the mass storage device which will enumerate in the step above. On Linux (tested with Ubuntu 22.04 LTS) no drivers need to be installed.</p>
</div>
<ol>
<li>Open a web browser at <strong>192.168.3.1</strong> to access the Septentrio configuration UI.</li>
<li>Go to the <strong>NMEA/SBF</strong> Out tab</li>
<li>Select <strong>+New SBF Stream</strong> &gt; <strong>Serial Port</strong> &gt; <strong>COM1</strong></li>
<li>Set interval to <strong>100ms</strong>.</li>
<li>Check <strong>Position</strong> and <strong>Status</strong> categories</li>
<li>Select <strong>Finish</strong> &gt; <strong>OK</strong></li>
<li>Navigate to the <strong>Admin</strong> tab &gt; <strong>Configurations</strong></li>
<li>Under <strong>Copy Configuration File</strong> set the <strong>Source: Current</strong> and <strong>Target: Boot</strong> and press <strong>OK</strong>. This will save the current configuration so it is applied again at the next boot.</li>
</ol>
<p>To ensure the settings were applied, we recommend power cycling, then reconnecting to the GNSS unit, navigate to NMEA/SBF Out tab and ensure the output you set up in the previous step has persisted across a power cycle.</p>
<p>At this time, we recommend repeating the settings for COM2, configuring the stream type desired for software which may be running on the Jetson. However, it is more typical for software to ingest <strong>NMEA GLL</strong> and <strong>GSA</strong> messages so we recommend using these messages for the output on COM2 for both the X-5 and H.</p>
<h3 id="using-the-septentrio-h-for-both-gnss-position-and-heading">Using the Septentrio H for both GNSS position and heading.<a class="headerlink" href="#using-the-septentrio-h-for-both-gnss-position-and-heading" title="Permanent link">&para;</a></h3>
<p>The Septentrio Mosaic H is capable of calculating static heading if two antennas are used in the appropriate way. Please refer to the Mosaic-H manual for more innformation. To enable heading on the Mosaic H, you need to ensure that the <strong>AttEuler</strong> and <strong>AttCovEuler</strong> SBF messages are configured (see instructios above for setting up a SBF stream). Then the following parameters should be configured in ArduPilot:</p>
<table>
<thead>
<tr>
<th>ArduPilot Parameter</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AHRS_EKF_TYPE</td>
<td>3</td>
<td>Enable use for EKF3</td>
</tr>
<tr>
<td>EKF2_ENABLE</td>
<td>0</td>
<td>Disable EKF2</td>
</tr>
<tr>
<td>EKF3_ENABLE</td>
<td>1</td>
<td>Enable EKF3</td>
</tr>
<tr>
<td>EKF_MAG_CAL</td>
<td>2 (for ArduRover)</td>
<td>Can be left at default value</td>
</tr>
<tr>
<td>EK3_SRC1_YAW</td>
<td>2 or 3</td>
<td>Set to 2 if using GPS Heading only, or 3 if a compass(es) is also in the system</td>
</tr>
<tr>
<td>GPS_TYPE</td>
<td>26 (SBF-Heading)</td>
<td>Sets the GPS type to include heading</td>
</tr>
<tr>
<td>GPS_MB1_OFS_X</td>
<td>USER DEFINED</td>
<td>X position of the base (primary) GPS antenna in body frame from the position of the 2nd antenna</td>
</tr>
<tr>
<td>GPS_MB1_OFS_Y</td>
<td>USER DEFINED</td>
<td>Y position of the base (primary) GPS antenna in body frame from the position of the 2nd antenna.</td>
</tr>
<tr>
<td>GPS_MB1_OFS_Z</td>
<td>USER DEFINED</td>
<td>Z position of the base (primary) GPS antenna in body frame from the position of the 2nd antenna</td>
</tr>
</tbody>
</table>
<p>Please find information <a href="https://customersupport.septentrio.com/s/article/How-to-integrate-latest-Septentrio-GNSS-receivers-with-Ardupilot-using-Pixhawk-standard-boards">here</a> for additional info about configuring Septentrio devices with ArduPilot. For additional information about the GPS_MB1_XXX_X parameters, please refer <a href="https://ardupilot.org/rover/docs/parameters.html#gps-mb1-parameters">here</a>.</p>
<h2 id="unique-board-identifier">Unique Board Identifier<a class="headerlink" href="#unique-board-identifier" title="Permanent link">&para;</a></h2>
<p>Each EchoPilot AI includes an AT24CS01-STUM unique ID EEPROM attached to the Jetson I2C 1 port at address 0x58. This can be used to obtain a unique 128-bit identifier (serial number) for your board. </p>
<p>Below is an example python script you can use to read this serial number.</p>
<p>First install python3 wih smbus
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>sudo apt-get install python3-smbus
</code></pre></div>
Create a new file <code>serial.py</code> with these contents:
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>import smbus
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>import sys
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a># usage, pass the i2c bus as the first argument, e.g. python3 serial_number 0
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>i2c_ch = int(sys.argv[1]) 
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a># address on the I2C bus
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>i2c_address = 0x58
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a># Register address
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>serial_num = 0x80
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a># Read serial number register
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>def read_serial():
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>    # Read the serial register, a 16 byte block
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>    val = bus.read_i2c_block_data(i2c_address, serial_num, 16)    
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>    return val
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a># Initialize I2C (SMBus)
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>bus = smbus.SMBus(i2c_ch)
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>try:
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>    # Print out the serial number
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>    print(bytes(read_serial()).hex())
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>except:
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>    pass
</code></pre></div>
You can then run the script using below, where the argument is the system's i2c bus. This may vary from different Jetson modules, but will most often by 0 or 1.
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>sudo python3 serial.py 0
</code></pre></div></p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024 <a href="echomav.com"  target="_blank" rel="noopener">EchoMAV, LLC</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/echomav" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.tracking", "navigation.instant", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy", "toc.follow", "content.action.edit", "content.action.view", "content.code.copy"], "search": "../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56dfad97.min.js"></script>
      
        <script src="../js/open_in_new_tab.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>